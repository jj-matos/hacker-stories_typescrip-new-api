{"ast":null,"code":"var _jsxFileName = \"/home/joao/Documents/02_MIND/05_IT/00_PROJECTS/my-hacker-news_typescript+new-api/src/App.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\n//#########\n// Imports\n//#########\nimport * as React from 'react';\nimport axios from 'axios';\nimport { SearchForm, StyledButtonLarge, StyledColumn } from './SearchForm.tsx';\nimport { List } from './List.tsx';\nimport styled from 'styled-components';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n//#######\n// Style\n//#######\nconst StyledContainer = styled.div`\n  height: 100vw;\n  padding: 20px;\n  background: #83a4d4;\n  background: linear-gradient(to left, #b6fbff, #83a4d4);\n  color:#171212;\n`;\n_c = StyledContainer;\nconst StyledHeadlinePrimary = styled.h1`\n  font-size: 48px;\n  font-weight: 300;\n  letter-spacing: 2px;\n`; //################################################################\n// Constants, Variables & Functions defined outside App component\n//################################################################\n//==========================================\n// Fetching data url with stories id's list\n//==========================================\n\n_c2 = StyledHeadlinePrimary;\nconst API_ENDPOINT = 'https://hacker-news.firebaseio.com/v0/topstories.json'; //=================================================\n// Saves searchTerm on local storage (Client Side)\n//=================================================\n\nconst useSemiPersistentState = (key, initialState) => {\n  _s();\n\n  const [value, setValue] = React.useState([localStorage.getItem(key) || initialState]);\n  React.useEffect(() => {\n    localStorage.setItem(key, value[value.length - 1]);\n    console.log('Search (input) value saved on local storage:');\n    console.log(localStorage.getItem(key) || initialState);\n  }, [value, key]);\n  console.log('return from useSemiPersistentState');\n  console.log(value);\n  return [value, setValue];\n}; //===========================\n// Manages App state changes\n//===========================\n\n\n_s(useSemiPersistentState, \"LgBzitspBKXTsAvEWih4n6m2q34=\");\n\nconst storiesReducer = (state, action) => {\n  switch (action.type) {\n    case 'STORIES_FETCH_INIT':\n      return { ...state,\n        isLoading: true,\n        isError: false\n      };\n\n    case 'STORIES_FETCH_SUCCESS':\n      console.log('storiesReducer called. State update: data');\n      console.log(action.payload);\n      return { ...state,\n        isLoading: false,\n        isError: false,\n        data: action.payload\n      };\n\n    case 'STORIES_FETCH_FAILURE':\n      return { ...state,\n        isLoading: false,\n        isError: true\n      };\n\n    case 'REMOVE_STORY':\n      console.log(action.payload);\n      console.log(state.data);\n      return { ...state,\n        data: state.data.filter(story => action.payload.id !== story.data.id)\n      };\n\n    default:\n      throw new Error();\n  }\n};\n\nconst getLastSearches = searches => searches.slice(-5); //###############\n// App component\n//###############\n\n\nconst App = () => {\n  _s2();\n\n  console.log('App renders'); //=======\n  // Hooks\n  //=======\n\n  const [searches, setSearches] = useSemiPersistentState('search', 'React');\n  const [url, setUrl] = React.useState(`${API_ENDPOINT}`);\n  const [stories, dispatchStories] = React.useReducer(storiesReducer, {\n    data: [],\n    isLoading: false,\n    isError: false\n  }); //============================================================\n  // Fetches individual stories by id, stores them in an array,\n  // and updates data in the app state\n  //============================================================\n\n  const getAsyncStories = async fetchedIdList => {\n    console.log('Promise called:');\n    console.log(fetchedIdList.data);\n    const storiesArray = [];\n    await Promise.all(fetchedIdList.data.map(async item => {\n      const story = await axios.get(`https://hacker-news.firebaseio.com/v0/item/${item}.json`);\n      storiesArray.push(story);\n    }));\n    console.log('Dispaching:');\n    console.log(storiesArray);\n    dispatchStories({\n      type: 'STORIES_FETCH_SUCCESS',\n      payload: storiesArray\n    });\n  }; //====================================================\n  // Fetches stories id's list from API, \n  // following an url change or an event,\n  // and updates state data with individual items array\n  // referenced to the id's in the initial id's list\n  //====================================================\n\n\n  const handleFetchStories = React.useCallback(async () => {\n    dispatchStories({\n      type: 'STORIES_FETCH_INIT'\n    });\n\n    try {\n      const fetchedIdList = await axios.get(url);\n      console.log('Data fetched:');\n      console.log(fetchedIdList.data);\n      await getAsyncStories(fetchedIdList);\n      console.log('Data changed in state'); //This useEffect doesn't work here. Gives an error - Why?\n\n      /*React.useEffect(() => {\n      getAsyncStories().then(result => {\n      console.log(1);\n      dispatchStories({\n        type: 'STORIES_FETCH_SUCCESS',\n        payload: result.stories.data,\n      });\n      });\n      },[]);\n      //This one also not - Why?\n      /*React.useEffect(() => {\n      console.log(Test use.Effect);\n      },[]);*/\n    } catch (error) {\n      dispatchStories({\n        type: 'STORIES_FETCH_FAILURE'\n      });\n    }\n  }, [searches]);\n  React.useEffect(() => {\n    handleFetchStories();\n  }, [handleFetchStories]);\n  /*const handleSort = (\n    event: React.ChangeEvent<HTMLButtonElement>\n   ) => {\n    setSortOption(sortOption);\n  };*/\n  //=================================================\n  // Changes searchTerm following input field change\n  //=================================================\n\n  const handleSearchInput = event => {\n    setSearches(searches.concat(event.target.value));\n    console.log('setSearches called');\n  }; //==================================\n  // Removes story from rendered list\n  //==================================\n\n\n  const handleRemoveStory = item => {\n    dispatchStories({\n      type: 'REMOVE_STORY',\n      payload: item\n    });\n  }; //=======================================\n  // Handles submit button click triggers:\n  // - Fetches id list from url\n  // - Saves search to be rendered with \n  //   previous searches buttons\n  //=======================================\n\n\n  const handleSearchSubmit = event => {\n    handleSearch(searchTerm);\n    event.preventDefault();\n  }; //=======================\n  // Handles last searches \n  //=======================\n\n\n  const handlePreviousSearch = searchTerm => {\n    handleSearch(searchTerm);\n  }; //##################\n  // Handles searches\n  //##################\n\n\n  const handleSearch = searchTerm => {\n    setSearches(searches.concat(searchTerm));\n  };\n\n  const lastSearches = getLastSearches(searches);\n  const lastSearch = searches[searches.length - 1]; //=============\n  // Renders App\n  //=============\n\n  return /*#__PURE__*/_jsxDEV(StyledContainer, {\n    children: [console.log(stories.data), console.log(stories.isLoading), /*#__PURE__*/_jsxDEV(StyledHeadlinePrimary, {\n      children: \"My Hacker Stories\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 312,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(SearchForm, {\n      searchTerm: lastSearch,\n      onSearchInput: handleSearchInput,\n      onSearchSubmit: handleSearchSubmit\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 314,\n      columnNumber: 7\n    }, this), lastSearches.map((searchTerm, index) => /*#__PURE__*/_jsxDEV(StyledColumn, {\n      children: /*#__PURE__*/_jsxDEV(StyledButtonLarge, {\n        type: \"button\",\n        onClick: () => handlePreviousSearch(searchTerm),\n        children: searchTerm\n      }, searchTerm + index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 322,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 321,\n      columnNumber: 9\n    }, this)), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 332,\n      columnNumber: 7\n    }, this), stories.isError && /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Something went wrong ...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 333,\n      columnNumber: 27\n    }, this), console.log(stories.isLoading), stories.isLoading ? /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Loading ...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 336,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [console.log(stories.data), console.log(lastSearch), /*#__PURE__*/_jsxDEV(List, {\n        list: stories.data,\n        searchTerm: lastSearch,\n        onRemoveItem: handleRemoveStory\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 341,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 309,\n    columnNumber: 5\n  }, this);\n}; //#########\n// Exports\n//#########\n\n\n_s2(App, \"LuCObxOP+mAKV9C2/tslsA4OeYc=\", false, function () {\n  return [useSemiPersistentState];\n});\n\n_c3 = App;\nexport default App;\nexport { storiesReducer, SearchForm, List };\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"StyledContainer\");\n$RefreshReg$(_c2, \"StyledHeadlinePrimary\");\n$RefreshReg$(_c3, \"App\");","map":{"version":3,"sources":["/home/joao/Documents/02_MIND/05_IT/00_PROJECTS/my-hacker-news_typescript+new-api/src/App.tsx"],"names":["React","axios","SearchForm","StyledButtonLarge","StyledColumn","List","styled","StyledContainer","div","StyledHeadlinePrimary","h1","API_ENDPOINT","useSemiPersistentState","key","initialState","value","setValue","useState","localStorage","getItem","useEffect","setItem","length","console","log","storiesReducer","state","action","type","isLoading","isError","payload","data","filter","story","id","Error","getLastSearches","searches","slice","App","setSearches","url","setUrl","stories","dispatchStories","useReducer","getAsyncStories","fetchedIdList","storiesArray","Promise","all","map","item","get","push","handleFetchStories","useCallback","error","handleSearchInput","event","concat","target","handleRemoveStory","handleSearchSubmit","handleSearch","searchTerm","preventDefault","handlePreviousSearch","lastSearches","lastSearch","index"],"mappings":"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","sourcesContent":["//#########\n// Imports\n//#########\n\nimport * as React from 'react';\nimport axios from 'axios';\n\nimport { SearchForm, StyledButtonLarge, StyledColumn } from './SearchForm.tsx';\nimport { List } from './List.tsx';\n\nimport styled from 'styled-components';\n\nimport { ReactComponent as Check } from './check.svg';\n\n//#######\n// Style\n//#######\n\nconst StyledContainer = styled.div`\n  height: 100vw;\n  padding: 20px;\n  background: #83a4d4;\n  background: linear-gradient(to left, #b6fbff, #83a4d4);\n  color:#171212;\n`;\n\nconst StyledHeadlinePrimary = styled.h1`\n  font-size: 48px;\n  font-weight: 300;\n  letter-spacing: 2px;\n`;\n\n//################################################################\n// Constants, Variables & Functions defined outside App component\n//################################################################\n\n//==========================================\n// Fetching data url with stories id's list\n//==========================================\n\nconst API_ENDPOINT = 'https://hacker-news.firebaseio.com/v0/topstories.json';\n\n//=================================================\n// Saves searchTerm on local storage (Client Side)\n//=================================================\n\ninterface StoriesFetchInitAction {\n  type: 'STORIES_FETCH_INIT';\n}\n\ninterface StoriesFetchSuccessAction {\n  type: 'STORIES_FETCH_SUCCESS';\n  payload: Stories;\n}\n\ninterface StoriesFetchFailureAction {\n  type: 'STORIES_FETCH_FAILURE';\n}\n\ninterface StoriesRemoveAction {\n  type: 'REMOVE_STORY';\n  payload: Story;\n}\n\ntype StoriesAction = \n  | StoriesFetchInitAction\n  | StoriesFetchSuccessAction\n  | StoriesFetchFailureAction\n  | StoriesRemoveAction;\n\nconst useSemiPersistentState = (\n  key: string,\n  initialState: string,\n ): [Array<string>, (newValue: Array<string>) => void] => {\n  const [value, setValue] = React.useState([\n    localStorage.getItem(key) || initialState\n  ]);\n\n  React.useEffect(() => {\n    localStorage.setItem(key, value[value.length -1]);\n    console.log('Search (input) value saved on local storage:');\n    console.log(localStorage.getItem(key) || initialState);\n  }, [value, key]);\n  \n  console.log('return from useSemiPersistentState');\n  console.log(value);\n  return [value, setValue];\n};\n\n//===========================\n// Manages App state changes\n//===========================\n\ntype StoriesState = {\n  data: Stories;\n  isLoading: boolean;\n  isError: boolean;\n};\n\nconst storiesReducer = (\n  state: StoriesState,\n  action: StoriesAction\n) => {\n  switch (action.type) {\n    case 'STORIES_FETCH_INIT':\n      return {\n        ...state,\n        isLoading: true,\n        isError: false,\n      };\n    case 'STORIES_FETCH_SUCCESS':\n      console.log('storiesReducer called. State update: data');\n      console.log(action.payload);\n      return {\n        ...state,\n        isLoading: false,\n        isError: false,\n        data: action.payload,\n      };\n    case 'STORIES_FETCH_FAILURE':\n      return {\n        ...state,\n        isLoading: false,\n        isError: true,\n      };\n    case 'REMOVE_STORY':\n      console.log(action.payload);\n      console.log(state.data);\n      return {\n        ...state,\n        data: state.data.filter(\n          (story) => action.payload.id !== story.data.id\n        ),\n      };\n    default:\n      throw new Error();\n  }\n};\n\nconst getLastSearches = (searches) => searches.slice(-5);\n\n//###############\n// App component\n//###############\n\nconst App = () => {\n  console.log('App renders');\n\n//=======\n// Hooks\n//=======\n\n  const [searches, setSearches] = useSemiPersistentState(\n    'search',\n    'React'\n  );\n\n  const [url, setUrl] = React.useState(\n    `${API_ENDPOINT}`\n  );\n\n  const [stories, dispatchStories] = React.useReducer(\n    storiesReducer,\n    { data: [], isLoading: false, isError: false }\n  );\n\n//============================================================\n// Fetches individual stories by id, stores them in an array,\n// and updates data in the app state\n//============================================================\n\n  const getAsyncStories = async (fetchedIdList) => {\n    console.log('Promise called:');\n    console.log(fetchedIdList.data);\n    \n    const storiesArray = [];\n\n    await Promise.all (\n      fetchedIdList.data.map(\n        async (item) => {\n          const story = await axios.get(`https://hacker-news.firebaseio.com/v0/item/${item}.json`);\n          storiesArray.push(story);\n        }\n      )\n    )\n    console.log('Dispaching:');\n    console.log(storiesArray);\n\n    dispatchStories({\n      type: 'STORIES_FETCH_SUCCESS',\n      payload: storiesArray,\n    });\n\n  };\n\n//====================================================\n// Fetches stories id's list from API, \n// following an url change or an event,\n// and updates state data with individual items array\n// referenced to the id's in the initial id's list\n//====================================================\n\n  const handleFetchStories = React.useCallback(async () => {\n    dispatchStories({ type: 'STORIES_FETCH_INIT' });\n\n    try {\n      const fetchedIdList = await axios.get(url);\n      console.log('Data fetched:');\n      console.log(fetchedIdList.data);\n\n      await getAsyncStories(fetchedIdList);\n      console.log('Data changed in state');\n\n      //This useEffect doesn't work here. Gives an error - Why?\n            /*React.useEffect(() => {\n          getAsyncStories().then(result => {\n            console.log(1);\n            dispatchStories({\n              type: 'STORIES_FETCH_SUCCESS',\n              payload: result.stories.data,\n            });\n          });\n      },[]);\n\n      //This one also not - Why?\n            /*React.useEffect(() => {\n        console.log(Test use.Effect);\n      },[]);*/\n\n\n    } catch (error) {\n      dispatchStories({ type: 'STORIES_FETCH_FAILURE' });\n    }\n  }, [searches]);\n\n  React.useEffect(() => {\n    handleFetchStories();\n    }, [handleFetchStories]);\n\n  /*const handleSort = (\n    event: React.ChangeEvent<HTMLButtonElement>\n   ) => {\n    setSortOption(sortOption);\n  };*/\n\n//=================================================\n// Changes searchTerm following input field change\n//=================================================\n\n  const handleSearchInput = (\n    event: React.ChangeEvent<HTMLInputElement>\n  ) => {\n    setSearches(searches.concat(event.target.value));\n    console.log('setSearches called');\n  };\n\n//==================================\n// Removes story from rendered list\n//==================================\n\n  const handleRemoveStory = (item: Story) => {\n    \n    dispatchStories({\n      type: 'REMOVE_STORY',\n      payload: item,\n    });\n  };\n\n//=======================================\n// Handles submit button click triggers:\n// - Fetches id list from url\n// - Saves search to be rendered with \n//   previous searches buttons\n//=======================================\n\n  const handleSearchSubmit = (\n   event: React.FormEvent<HTMLFormElement>\n  ) => {\n    \n    handleSearch(searchTerm);\n\n    event.preventDefault();\n  };\n\n//=======================\n// Handles last searches \n//=======================\n\n  const handlePreviousSearch = (searchTerm) => {\n    handleSearch(searchTerm);\n  };\n\n//##################\n// Handles searches\n//##################\n\n  const handleSearch = (searchTerm) => {\n    setSearches(searches.concat(searchTerm));\n  };\n\n  const lastSearches = getLastSearches(searches);\n  const lastSearch = searches[searches.length - 1];\n\n//=============\n// Renders App\n//=============\n\n  return (\n    <StyledContainer>\n      {console.log(stories.data)}\n      {console.log(stories.isLoading)}\n      <StyledHeadlinePrimary>My Hacker Stories</StyledHeadlinePrimary>\n\n      <SearchForm\n        searchTerm={lastSearch}\n        onSearchInput={handleSearchInput}\n        onSearchSubmit={handleSearchSubmit}\n      />\n\n      {lastSearches.map((searchTerm, index) => (\n        <StyledColumn>\n          <StyledButtonLarge\n            key={searchTerm+index}\n            type=\"button\"\n            onClick={() => handlePreviousSearch(searchTerm)}\n          >\n            {searchTerm}\n          </StyledButtonLarge>\n        </StyledColumn>\n      ))}\n\n      <hr />\n      {stories.isError && <p>Something went wrong ...</p>}\n      {console.log(stories.isLoading)}\n      {stories.isLoading ? (\n        <p>Loading ...</p>\n      ) : (\n        <>\n        {console.log(stories.data)}\n        {console.log(lastSearch)}\n        <List\n          list={stories.data}\n          searchTerm={lastSearch}\n          onRemoveItem={handleRemoveStory}\n        />\n        </>\n      )}\n    </StyledContainer>\n  );\n};\n\n//#########\n// Exports\n//#########\n\nexport default App;\n\nexport { storiesReducer, SearchForm, List};\n\n"]},"metadata":{},"sourceType":"module"}