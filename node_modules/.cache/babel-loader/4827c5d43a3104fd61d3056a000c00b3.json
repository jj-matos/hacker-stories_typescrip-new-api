{"ast":null,"code":"import _asyncToGenerator from\"/home/joao/Documents/02_MIND/05_IT/04_CODING/REACT/hacker-stories/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _objectSpread from\"/home/joao/Documents/02_MIND/05_IT/04_CODING/REACT/hacker-stories/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/home/joao/Documents/02_MIND/05_IT/04_CODING/REACT/hacker-stories/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"/home/joao/Documents/02_MIND/05_IT/04_CODING/REACT/hacker-stories/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2;import _regeneratorRuntime from\"/home/joao/Documents/02_MIND/05_IT/04_CODING/REACT/hacker-stories/node_modules/@babel/runtime/regenerator/index.js\";import*as React from'react';import axios from'axios';import{SearchForm}from'./SearchForm.tsx';import{List}from'./List.tsx';import styled from'styled-components';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var StyledContainer=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  height: 100vw;\\n  padding: 20px;\\n  background: #83a4d4;\\n  background: linear-gradient(to left, #b6fbff, #83a4d4);\\n  color:#171212;\\n\"])));var StyledHeadlinePrimary=styled.h1(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  font-size: 48px;\\n  font-weight: 300;\\n  letter-spacing: 2px;\\n\"])));var API_ENDPOINT='https://hacker-news.firebaseio.com/v0/topstories.json';var useSemiPersistentState=function useSemiPersistentState(key,initialState){var _React$useState=React.useState(localStorage.getItem(key)||initialState),_React$useState2=_slicedToArray(_React$useState,2),value=_React$useState2[0],setValue=_React$useState2[1];console.log(7);React.useEffect(function(){localStorage.setItem(key,value);},[value,key]);return[value,setValue];};var storiesReducer=function storiesReducer(state,action){switch(action.type){case'STORIES_FETCH_INIT':return _objectSpread(_objectSpread({},state),{},{isLoading:true,isError:false});case'STORIES_FETCH_SUCCESS':console.log(action.payload);return _objectSpread(_objectSpread({},state),{},{isLoading:false,isError:false,data:action.payload});case'STORIES_FETCH_FAILURE':return _objectSpread(_objectSpread({},state),{},{isLoading:false,isError:true});case'REMOVE_STORY':return _objectSpread(_objectSpread({},state),{},{data:state.data.filter(function(story){return action.payload.id!==story.id;})});default:throw new Error();}};var App=function App(){console.log(8);var _useSemiPersistentSta=useSemiPersistentState('search','React'),_useSemiPersistentSta2=_slicedToArray(_useSemiPersistentSta,2),searchTerm=_useSemiPersistentSta2[0],setSearchTerm=_useSemiPersistentSta2[1];/*const [sortOption, setSortOption] = useSemiPersistentState(\n    'sort',\n    ''\n  );*/var _React$useState3=React.useState(\"\".concat(API_ENDPOINT)),_React$useState4=_slicedToArray(_React$useState3,2),url=_React$useState4[0],setUrl=_React$useState4[1];var _React$useReducer=React.useReducer(storiesReducer,{data:[],isLoading:false,isError:false}),_React$useReducer2=_slicedToArray(_React$useReducer,2),stories=_React$useReducer2[0],dispatchStories=_React$useReducer2[1];var handleFetchStories=React.useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var result,storiesArray,getAsyncStories;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatchStories({type:'STORIES_FETCH_INIT'});_context.prev=1;_context.next=4;return axios.get(url);case 4:result=_context.sent;console.log(result.data);storiesArray=[];getAsyncStories=function getAsyncStories(){return Promise.resolve(result.data.map(function(item){return fetch(\"https://hacker-news.firebaseio.com/v0/item/\".concat(item,\".json\")).then(function(response){return response.json();})//.then (console.log(item))\n.then(function(story){storiesArray.push(story);});}));};console.log(storiesArray);console.log(2);//This useEffect doesn't work here - Why?????\n/*React.useEffect(() => {\n        console.log(3);\n      }, []);*/ //This one also not - Why?\n/*React.useEffect(() => {\n          getAsyncStories().then(result => {\n            console.log(1);\n            dispatchStories({\n              type: 'STORIES_FETCH_SUCCESS',\n              payload: result.stories.data,\n            });\n          });\n      },[]);\n      console.log(4);*/getAsyncStories().then(function(){console.log(1);console.log(storiesArray);dispatchStories({type:'STORIES_FETCH_SUCCESS',payload:storiesArray});});console.log(5);//console.log(Stories);\n_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](1);dispatchStories({type:'STORIES_FETCH_FAILURE'});case 17:case\"end\":return _context.stop();}}},_callee,null,[[1,14]]);})),[url]);React.useEffect(function(){handleFetchStories();},[handleFetchStories]);/*const handleSort = (\n    event: React.ChangeEvent<HTMLButtonElement>\n   ) => {\n    setSortOption(sortOption);\n  };*/var handleSearchInput=function handleSearchInput(event){setSearchTerm(event.target.value);};var handleRemoveStory=function handleRemoveStory(item){dispatchStories({type:'REMOVE_STORY',payload:item});};var handleSearchSubmit=function handleSearchSubmit(event){setUrl(\"\".concat(API_ENDPOINT));event.preventDefault();};/*const setSort = React.useCallback(()) => {\n    const [sort, setSort] = React.useState ([]);\n\n    <List\n      list={stories.data}\n      sortList={sortType}\n      onRemoveItem={handleRemoveStory}\n    />\n  }\n  \n  React.useEffect(()) => {\n    setSort()\n  }, [setSort]);*/return/*#__PURE__*/_jsxs(StyledContainer,{children:[/*#__PURE__*/_jsx(StyledHeadlinePrimary,{children:\"My Hacker Stories\"}),/*#__PURE__*/_jsx(SearchForm,{searchTerm:searchTerm,onSearchInput:handleSearchInput,onSearchSubmit:handleSearchSubmit}),/*#__PURE__*/_jsx(\"hr\",{}),stories.isError&&/*#__PURE__*/_jsx(\"p\",{children:\"Something went wrong ...\"}),stories.isLoading?/*#__PURE__*/_jsx(\"p\",{children:\"Loading ...\"}):/*#__PURE__*/_jsx(List,{list:stories.data,onRemoveItem:handleRemoveStory})]});};export default App;export{storiesReducer,SearchForm,List};","map":{"version":3,"sources":["/home/joao/Documents/02_MIND/05_IT/04_CODING/REACT/hacker-stories/src/App.tsx"],"names":["React","axios","SearchForm","List","styled","StyledContainer","div","StyledHeadlinePrimary","h1","API_ENDPOINT","useSemiPersistentState","key","initialState","useState","localStorage","getItem","value","setValue","console","log","useEffect","setItem","storiesReducer","state","action","type","isLoading","isError","payload","data","filter","story","id","Error","App","searchTerm","setSearchTerm","url","setUrl","useReducer","stories","dispatchStories","handleFetchStories","useCallback","get","result","storiesArray","getAsyncStories","Promise","resolve","map","item","fetch","then","response","json","push","handleSearchInput","event","target","handleRemoveStory","handleSearchSubmit","preventDefault"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport axios from 'axios';\n\nimport { SearchForm } from './SearchForm.tsx';\nimport { List } from './List.tsx';\n\nimport styled from 'styled-components';\n\nimport { ReactComponent as Check } from './check.svg';\n\nconst StyledContainer = styled.div`\n  height: 100vw;\n  padding: 20px;\n  background: #83a4d4;\n  background: linear-gradient(to left, #b6fbff, #83a4d4);\n  color:#171212;\n`;\n\nconst StyledHeadlinePrimary = styled.h1`\n  font-size: 48px;\n  font-weight: 300;\n  letter-spacing: 2px;\n`;\n\nconst API_ENDPOINT = 'https://hacker-news.firebaseio.com/v0/topstories.json';\n\nconst useSemiPersistentState = (\n  key: string,\n  initialState: string\n ): [string, (newValue: string) => void] => {\n  const [value, setValue] = React.useState(\n    localStorage.getItem(key) || initialState\n  );\n  console.log(7);\n  React.useEffect(() => {\n    localStorage.setItem(key, value);\n  }, [value, key]);\n\n  return [value, setValue];\n};\n\ntype StoriesState = {\n  data: Stories;\n  isLoading: boolean;\n  isError: boolean;\n};\n\ninterface StoriesFetchInitAction {\n  type: 'STORIES_FETCH_INIT';\n}\n\ninterface StoriesFetchSuccessAction {\n  type: 'STORIES_FETCH_SUCCESS';\n  payload: Stories;\n}\n\ninterface StoriesFetchFailureAction {\n  type: 'STORIES_FETCH_FAILURE';\n}\n\ninterface StoriesRemoveAction {\n  type: 'REMOVE_STORY';\n  payload: Story;\n}\n\ntype StoriesAction = \n  | StoriesFetchInitAction\n  | StoriesFetchSuccessAction\n  | StoriesFetchFailureAction\n  | StoriesRemoveAction;\n\nconst storiesReducer = (\n  state: StoriesState,\n  action: StoriesAction\n) => {\n  switch (action.type) {\n    case 'STORIES_FETCH_INIT':\n      return {\n        ...state,\n        isLoading: true,\n        isError: false,\n      };\n    case 'STORIES_FETCH_SUCCESS':\n      console.log(action.payload);\n      return {\n        ...state,\n        isLoading: false,\n        isError: false,\n        data: action.payload,\n      };\n    case 'STORIES_FETCH_FAILURE':\n      return {\n        ...state,\n        isLoading: false,\n        isError: true,\n      };\n    case 'REMOVE_STORY':\n      return {\n        ...state,\n        data: state.data.filter(\n          (story) => action.payload.id !== story.id\n        ),\n      };\n    default:\n      throw new Error();\n  }\n};\n\nconst App = () => {\n  console.log(8);\n  const [searchTerm, setSearchTerm] = useSemiPersistentState(\n    'search',\n    'React'\n  );\n  \n /*const [sortOption, setSortOption] = useSemiPersistentState(\n    'sort',\n    ''\n  );*/\n\n  const [url, setUrl] = React.useState(\n    `${API_ENDPOINT}`\n  );\n\n  const [stories, dispatchStories] = React.useReducer(\n    storiesReducer,\n    { data: [], isLoading: false, isError: false }\n  );\n\n  const handleFetchStories = React.useCallback(async () => {\n    dispatchStories({ type: 'STORIES_FETCH_INIT' });\n\n    try {\n      const result = await axios.get(url);\n      console.log(result.data);\n\n      const storiesArray = [];\n\n      const getAsyncStories = () => \n        Promise.resolve(\n          result.data.map(\n            item => (\n              fetch (`https://hacker-news.firebaseio.com/v0/item/${item}.json`)\n              .then (response => response.json())\n              //.then (console.log(item))\n              .then (story => {\n                storiesArray.push(story)\n              })\n            )\n          )\n        );\n\n      console.log(storiesArray);\n      console.log(2);\n      //This useEffect doesn't work here - Why?????\n      /*React.useEffect(() => {\n        console.log(3);\n      }, []);*/\n\n      //This one also not - Why?\n      /*React.useEffect(() => {\n          getAsyncStories().then(result => {\n            console.log(1);\n            dispatchStories({\n              type: 'STORIES_FETCH_SUCCESS',\n              payload: result.stories.data,\n            });\n          });\n      },[]);\n      console.log(4);*/\n\n     \n      getAsyncStories().then(() => {\n        console.log(1);\n        console.log(storiesArray);\n        dispatchStories({\n          type: 'STORIES_FETCH_SUCCESS',\n          payload: storiesArray,\n        });\n      });\n\n      console.log(5);\n      \n\n      //console.log(Stories);\n\n    } catch (error) {\n      dispatchStories({ type: 'STORIES_FETCH_FAILURE' });\n    }\n  }, [url]);\n\n  React.useEffect(() => {\n    handleFetchStories();\n    }, [handleFetchStories]);\n\n  /*const handleSort = (\n    event: React.ChangeEvent<HTMLButtonElement>\n   ) => {\n    setSortOption(sortOption);\n  };*/\n\n  const handleSearchInput = (\n    event: React.ChangeEvent<HTMLInputElement>\n  ) => {\n    setSearchTerm(event.target.value);\n  };\n\n  const handleRemoveStory = (item: Story) => {\n    dispatchStories({\n      type: 'REMOVE_STORY',\n      payload: item,\n    });\n  };\n\n  const handleSearchSubmit = (\n   event: React.FormEvent<HTMLFormElement>\n  ) => {\n    setUrl(`${API_ENDPOINT}`);\n\n    event.preventDefault();\n  };\n\n\n\n  /*const setSort = React.useCallback(()) => {\n    const [sort, setSort] = React.useState ([]);\n\n    <List\n      list={stories.data}\n      sortList={sortType}\n      onRemoveItem={handleRemoveStory}\n    />\n  }\n  \n  React.useEffect(()) => {\n    setSort()\n  }, [setSort]);*/\n\n  return (\n    <StyledContainer>\n      <StyledHeadlinePrimary>My Hacker Stories</StyledHeadlinePrimary>\n\n      <SearchForm\n        searchTerm={searchTerm}\n        onSearchInput={handleSearchInput}\n        onSearchSubmit={handleSearchSubmit}\n      />\n\n      <hr />\n      {stories.isError && <p>Something went wrong ...</p>}\n\n      {stories.isLoading ? (\n        <p>Loading ...</p>\n      ) : (\n        <List\n          list={stories.data}\n          onRemoveItem={handleRemoveStory}\n        />\n      )}\n    </StyledContainer>\n  );\n};\n\nexport default App;\n\nexport { storiesReducer, SearchForm, List};\n\n"]},"metadata":{},"sourceType":"module"}